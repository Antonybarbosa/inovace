SELECT 

VEN.CODVEND, 
VEN.APELIDO, 
NVL((
SELECT 
COUNT(DISTINCT(CAB.CODPARC)) AS CODPARCEIRO

FROM 

TGFITE ITE,
TGFCAB CAB,
TGFPRO PR,
TGFPAR PAR,
TGFTPP TPP

WHERE 
CAB.NUNOTA = ITE.NUNOTA AND
PR.CODPROD = ITE.CODPROD AND
CAB.CODPARC = PAR.CODPARC AND
PAR.CODTIPPARC = TPP.CODTIPPARC AND
CAB.CODVEND = VEN.CODVEND AND 
/*DN RENAL*/
PR.CODPROD IN ( 5140,
2096,
1288,
5123,
55,
56,
69,
5083,
71,
6695,
6696
)   AND
TRUNC(CAB.DTFATUR) BETWEEN :DTINI AND :DTFIM AND

CAB.TIPMOV = 'V' AND
CAB.STATUSNOTA = 'L' AND
CAB.CODTIPOPER IN ( 700, 703, 706, 707, 709, 715, 723,724, 725) AND
TPP.CODTIPPARC  IN(10101001, 10101004, 10101008, 10101010)
GROUP BY CAB.CODVEND
),0) AS REALIZADO,
NVL(DECODE(VEN.CODVEND,1,	14,
9,	5,
15,	5,
3,	19,
31,	12,
4,	14,
53, 8,
49,4,
17,	3,
39,	9,
7,	5,
19,	8,
8,	13,
16,	5,
5,	14,
30,	5,
14,	3,
11,	4,
49,	3,
12,	11
),0) AS META 

FROM TGFVEN VEN                       
WHERE VEN.CODEMP = 1
AND VEN.ATIVO = 'S'
AND VEN.CODVEND NOT IN(0,43, 27, 17,24, 44,2,35,32,52,42,40,14 )
ORDER BY META DESC